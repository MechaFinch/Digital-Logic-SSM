Switch to custom ALU to support things like shifts, simplify logic